<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  
  <!-- PWA相关meta标签 -->
  <meta name="description" content="一个便捷的地址首字母搜索和管理工具">
  <meta name="theme-color" content="#3b82f6">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="地址备忘录">

  
  <!-- manifest.json -->
  <link rel="manifest" href="manifest.json">
  
  <!-- 自定义字体导入 -->
  <style>
    @font-face {
      font-family: '汉字拼音体';
      src: url('./汉字拼音体.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
  </style>
  
  <title>地址首字母搜索备忘录</title>
  <!-- Tailwind CSS v3 (开发环境CDN，生产环境请使用PostCSS插件或Tailwind CLI) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- pinyin-pro 拼音转换库 -->
  <script src="https://unpkg.com/pinyin-pro@3.18.2/dist/index.js"></script>
  
  <!-- Tailwind 配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#007AFF',
            secondary: '#6B7280',
            accent: '#FF9500',
            light: '#F9FAFB',
            dark: '#1F2937'
          },
          fontFamily: {
            sans: ['汉字拼音体', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif']
          },
          boxShadow: {
            'card': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
            'popup': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)'
          }
        }
      }
    }
  </script>
  
  <!-- 引入外部样式文件 -->
  <link rel="stylesheet" href="styles.css">
  
  <style>
    /* 增加交互元素间距 */
    .flex.space-x-4 {
      gap: 1rem;
    }
  </style>
</head>
<body class="bg-gray-50 font-sans text-dark min-h-screen flex flex-col">
  
  <!-- 主要内容区域 -->
  <main class="flex-grow p-4 keyboard-avoidance">
    <!-- 文本编辑器页面 -->
    <div id="editor-page" class="h-full flex flex-col">
      <!-- 文件名显示（隐藏） -->
      <div id="filename-bar" class="p-2 bg-gray-50 border-b border-gray-200">
        <div id="filename-display" class="text-sm text-gray-700 truncate text-center">新备忘录1</div>
      </div>
      <textarea id="memo-editor" class="w-full h-full min-h-[300px] p-4 bg-white rounded-lg shadow-sm border border-gray-200 focus:border-primary focus:ring focus:ring-blue-200 focus:outline-none resize-none" placeholder="请输入地址和备注，格式如下：
地址1
备注1
备注2

地址2
备注1

（地址和备注之间用空行分隔，地址放在第一行，备注放在后续行）"></textarea>
    </div>
    
    <!-- 搜索结果页面 (初始隐藏) -->
    <div id="search-results-page" class="hidden">
      <div id="search-results-top-spacer"></div>
      
      <!-- 搜索结果标题栏 -->
      <div class="flex justify-between items-center mb-2">
        <h2 class="text-lg font-medium">搜索结果</h2>
        <div class="flex items-center space-x-4">
          <span id="results-count" class="text-sm text-secondary">已找到0项</span>
          <button id="close-search-results" class="p-2 rounded-full hover:bg-gray-100 text-secondary">
            <i class="fa fa-times"></i>
          </button>
        </div>
      </div>
      
      <!-- 搜索结果列表 -->
      <div id="search-results-list" class="space-y-3 overflow-y-auto">
        <!-- 搜索结果将通过JS动态生成 -->
      </div>
      
      <!-- 未找到结果提示 -->
      <div id="no-results-message" class="hidden text-center py-10">
        <i class="fa fa-search text-4xl text-gray-300 mb-3"></i>
        <p class="text-gray-500">未找到匹配的地址</p>
      </div>
    </div>
    
    <!-- 自动保存提示 -->
    <div id="auto-save-indicator" class="fixed bottom-24 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-70 text-white px-4 py-2 rounded-lg text-sm z-50 hidden">
      <span id="save-status">已自动保存</span>
    </div>
  </main>
  
  <!-- 底部功能区 -->
  <footer class="bg-white shadow-lg p-4 safe-area-bottom ios-footer sticky bottom-0 z-10">
    <div class="flex flex-col space-y-4">
      <!-- 搜索框 -->
      <div class="relative">
        <input 
          type="text" 
          id="search-input" 
          placeholder="输入地址首字母搜索（如'bjs'查北京）" 
          class="w-full pl-4 pr-10 ios-input"
          autocapitalize="off"
          autocorrect="off"
          spellcheck="false"
        >
        <button id="clear-input-btn" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary hidden ios-button">
          <i class="fa fa-times-circle"></i>
        </button>
      </div>
      
      <!-- 按钮容器 - 将在搜索页面隐藏 -->
      <div id="action-buttons-container">
        <!-- 操作按钮 -->
        <div class="flex justify-between items-center">
          <div class="flex space-x-4">
            <button id="file-switch-btn" class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-dark hover:bg-gray-200 transition-colors ios-button">
              <i class="fa fa-folder-o text-lg"></i>
            </button>
            <button id="new-file-btn" class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-dark hover:bg-gray-200 transition-colors ios-button">
              <i class="fa fa-plus text-lg"></i>
            </button>
            <button id="rename-file-btn" class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-dark hover:bg-gray-200 transition-colors ios-button">
              <i class="fa fa-pencil text-lg"></i>
            </button>
            <button id="import-clipboard-btn" class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-dark hover:bg-gray-200 transition-colors ios-button">
              <i class="fa fa-paste text-lg"></i>
            </button>
          </div>
          
          <div class="relative">
            <button id="secondary-menu-btn" class="bg-primary text-white px-6 py-3 rounded-full text-sm font-medium shadow-sm hover:bg-blue-600 transition-colors flex items-center ios-button">
              <i class="fa fa-bars mr-2"></i> 更多
            </button>
            <div id="secondary-menu" class="hidden absolute bottom-14 right-0 bg-white shadow-lg rounded-lg p-2 w-40 z-20">
              <button id="menu-save-btn" class="w-full py-2 px-3 text-sm rounded hover:bg-gray-100 flex items-center">
                <i class="fa fa-save mr-2"></i> 保存
              </button>
              <button id="menu-sync-btn" class="w-full py-2 px-3 text-sm rounded hover:bg-gray-100 flex items-center">
                <i class="fa fa-refresh mr-2"></i> 同步
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  
  <!-- 文件切换弹窗（初始隐藏） -->
  <div id="file-popup" class="hidden fixed inset-0 bg-black bg-opacity-50 z-30 flex flex-col">
    <div class="bg-white rounded-t-lg flex-grow overflow-auto">
      <div class="p-4 border-b">
        <h3 class="text-lg font-medium">选择文件</h3>
      </div>
      <div id="file-list" class="p-4 space-y-2">
        <!-- 文件列表将通过JS动态生成 -->
      </div>
    </div>
    <div class="bg-white p-4 rounded-b-lg">
      <button id="close-file-popup" class="w-full py-3 bg-gray-100 text-dark rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors">
        取消
      </button>
    </div>
  </div>
  
  <!-- 地址编辑弹窗（初始隐藏） -->
  <div id="edit-popup" class="hidden fixed inset-0 bg-black bg-opacity-50 z-30 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg w-full max-w-md max-h-[80vh] flex flex-col">
      <div class="p-4 border-b flex justify-between items-center">
        <h3 class="text-lg font-medium" id="edit-title">编辑地址</h3>
        <button id="close-edit-popup" class="text-secondary hover:text-dark">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div class="p-4 flex-grow overflow-auto">
        <textarea id="edit-content" class="w-full h-48 p-3 border rounded-lg text-sm resize-none" placeholder="请输入地址和备注，地址请放在第一行，备注放在后续行"></textarea>
      </div>
      <div class="p-4 border-t flex space-x-3">
        <button id="delete-address-btn" class="flex-1 py-2 bg-gray-100 text-dark rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors">
          删除
        </button>
        <button id="save-address-btn" class="flex-1 py-2 bg-primary text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors">
          保存
        </button>
      </div>
    </div>
  </div>
  
  <!-- 确认弹窗已删除，改用浏览器原生confirm -->
    
  <!-- 提示消息（初始隐藏） -->
  <div id="toast" class="fixed bottom-24 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-70 text-white px-4 py-2 rounded-lg text-sm z-50 hidden">
    <span id="toast-message"></span>
  </div>

  <!-- 引入模块化JavaScript文件 -->
  <script type="module" src="app-data.js"></script>
  <script type="module" src="file-management.js"></script>
  <script type="module" src="search-functionality.js"></script>
  <script type="module" src="ui-utils.js"></script>
  <script type="module" src="app.js"></script>
  
  <!-- 初始化应用 -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // 延迟初始化以确保所有模块加载完成
      setTimeout(window.initApp, 300);
    });
  </script>
</body>
</html>
